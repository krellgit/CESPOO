---
name: cespoo
description: Fetch, categorize, summarize emails and send daily digest
---

## What This Skill Does

1. Fetches emails from Krell@KeplerCommerce.com (last 24 hours, unread only)
2. Asks Claude Code to categorize and summarize them
3. Sends formatted summary to JohnKrell.StaAna1@gmail.com

## Instructions for Claude Code

When this skill is invoked:

1. Run the email fetcher:
   ```bash
   cd /mnt/c/Users/Krell/Documents/Imps/gits/CESPOO
   venv/bin/python3 process_emails.py
   ```

2. Read the emails from the generated file `emails_to_process.txt`

3. Analyze and categorize each email into these categories:
   - Amazon Advertising
   - Listing Optimization
   - Recent Trends in Amazon
   - AI Trends connected to Amazon
   - Other AI Trends
   - Uncategorized

4. Create a structured summary with:
   - Brief summary of each email (2-3 sentences max)
   - Group by category
   - Executive summary of most important items

5. Format the output as beautiful HTML using this template:

```html
<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #3498db;
            margin-top: 30px;
        }
        h3 {
            color: #34495e;
            margin-top: 20px;
        }
        .email-item {
            background-color: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #3498db;
            border-radius: 4px;
        }
        .meta {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 8px;
        }
        .summary {
            color: #2c3e50;
            line-height: 1.5;
        }
        .executive-summary {
            background-color: #e8f4f8;
            padding: 20px;
            border-left: 4px solid #2980b9;
            margin: 20px 0;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            color: #7f8c8d;
            font-size: 12px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“§ CESPOO Daily Email Summary</h1>
        <p class="meta"><strong>Date:</strong> [CURRENT_DATE]</p>
        <p class="meta"><strong>Emails Processed:</strong> [EMAIL_COUNT]</p>

        <div class="executive-summary">
            <h2>ðŸŽ¯ Executive Summary</h2>
            <p>[YOUR BRIEF EXECUTIVE SUMMARY OF THE MOST IMPORTANT ITEMS]</p>
        </div>

        [FOR EACH CATEGORY WITH EMAILS:]
        <h2>[CATEGORY NAME]</h2>

        [FOR EACH EMAIL IN CATEGORY:]
        <div class="email-item">
            <h3>[EMAIL SUBJECT]</h3>
            <p class="meta"><strong>From:</strong> [SENDER]</p>
            <p class="summary">[YOUR 2-3 SENTENCE SUMMARY]</p>
        </div>

        <div class="footer">
            <p>Generated by CESPOO - Claude Email Summarization and Priority On-demand Offloading</p>
            <p>Processed from Krell@KeplerCommerce.com via Claude Code</p>
        </div>
    </div>
</body>
</html>
```

6. Save the HTML to `summary.html`

7. Send the email:
   ```python
   from gmail_handler import GmailHandler
   from datetime import datetime
   import config

   # Read the HTML summary
   with open('summary.html', 'r') as f:
       html_content = f.read()

   # Send it
   gmail = GmailHandler()
   subject = f"ðŸ“§ CESPOO Daily Email Summary - {datetime.now().strftime('%b %d, %Y')}"
   gmail.send_email(
       to=config.DESTINATION_EMAIL,
       subject=subject,
       body=html_content
   )
   ```

8. Confirm to the user that the summary was sent successfully

## Notes

- The skill is on-demand - user decides when to run it
- No API costs - uses Claude Code's existing session
- First run will require Google OAuth authentication
- Emails are fetched from Krell@KeplerCommerce.com
- Summary sent to JohnKrell.StaAna1@gmail.com
